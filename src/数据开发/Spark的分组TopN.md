## **Spark的分组TopN**

- 先分组，toList然后在内存中排序，如果每个组数据较多，可能产生内存溢出
- 自定义分区器，按分组条件分区，在分区内toList排序，或者自定义排序规则，使用TreeSet，size大于N就去掉最小的
- 按分组条件过滤，然后使用RDD排序sortBy，会触发多次Action（排序后take），适合数据量大的情况